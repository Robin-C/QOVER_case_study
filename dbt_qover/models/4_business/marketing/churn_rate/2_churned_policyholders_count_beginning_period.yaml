version: 2

metrics:
  - name: churned_policyholders_count_beginning_period
    model: ref('gold_contracts_status_by_month')
    description: |
      "This is the number of policyholders we had at the beginning of the period (ie the number we had at last day of prev month) that have eventually churned.
      This metric is mostly used downstream to calculate the churn rate by reason."
    label: Number of Policyholders at beginning of period that have churned
    calculation_method: count
    expression: case when was_present_prev_period is true then 1 else null end

    dimensions:
      - year_month
    
    filters:
      - field: has_churned_this_period
        operator: 'is'
        value: 'true'