version: 2

metrics:
  - name: churn_rate
    label: Churn Rate
    description: "The churn rate by period"

    calculation_method: derived
    expression: "{{metric('policyholders_churn_period')}} / {{metric('policyholders_count_beginning_period')}} * 100"

    dimensions:
      - year_month
      - cancel_reason
      - language
    
    config:
      treat_null_values_as_zero: true